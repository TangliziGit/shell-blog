# [周报] 2023-08 可恶的157

# 工作

## 实习

花了两天时间了解了Flink的架构、快照生成方法和状态管理，主要是阅读了State Management in Apache Flink这篇论文还有一些零散的文档和博客。基本上亮点在于一致性快照生成算法（marker和对齐），还有搭配数据分区和状态分发解耦能做到基于快照的扩缩容。顺带了解了Flink的架构：TaskManager和slot的关系、共享slot、并发度和最大并发度、key groups和并发度的关系等。

剩下了一天的时间在阅读代码设计接口，大体是没有问题了，不过一些细节需要考虑。下周周一准备给整个内存的状态存储原型出来，试试看效果先。我估计至少得有个两天的样子，原型出来之后再跟大家讨论一下，没问题就正式开始打码。

## 毕业设计

前后端联调完成，顺便加了测试仓库的新页面、加上了任务cancel的接口。

aarch64方面，安装了CentOS7 AltArch能跑起来、解决了overlayfs挂载失败的问题，不过做dracut启动的时候估计是内核没有支持ELF64位的二进制可执行程序，导致一直报错`systemd[1]: Failed to execute /sbin/init, giving up: Exec format error`。解决方法的话，我需要编个内核出来试试能不能成，或者换个支持aarch64比较好的发行版。

功能完善方面，写好了事务化git语句，效果是多个进程对同一个repo做操作会上一个带超时的锁，原理是在.git里放了个内容是时间戳的文件锁 & 用原子性创建文件做的竞争控制。不过还没来得及做performance基准的测试，似乎邮件通知也没有写。不过这些问题不大，估计一个早上就整好。

部署环境的话，在实验室机器157上做了一半去睡觉了，回来就发现157宕机了。还得找同学重启，真头疼，估计下周了。可恶啊，实验室机器总是宕机。

总结一下下周工作：

- aarch64需要换个发行版跑测试，然后更新安装脚本；
- 支持performance测试和分析；支持邮件通知；
- 在157上部署一套至少可以联调的环境。

差不多满打满算三天时间，可能要在周末加班了。

===================

pgrep

pkill -P 

ps -p PID -o pgid=

# 学习

## CMU15445

> - B+Tree Insertions：https://www.youtube.com/watch?v=h6Mw7_S4ai0
> - B+Tree Deletions：https://www.youtube.com/watch?v=QrbaQDSuxIM

接着上周的B+Tree Task2，增删逻辑写好了不过没有测试，估计bug一堆。然后要说的是上面两个B+Tree增删的逻辑只能用在单线程上，因为多线程需要考虑的是影响范围最小化，所以不能说删除时直接borrow next page，而是应该borrow 任意一个sibling。

# 生活

## 运动

这周的成绩不行啊，四舍五入体重没变，也就少了0.05kg。这周运动量1073千卡，比上周少了300千卡左右，那我觉得是运动少了而不是饮食问题。想起来上上周跑步还能大概有3000千卡的输出。我似乎得跑步了。

## 板绘

这周毕设实习双重压力了，板绘的时间拿去打游戏了：）

不过我至少收获了快乐。