# [周报] 2023-07 实习毕设双重压力

# 工作

## DolphinDB

跟同事讨论的时候，发现原先的设计里恢复过程有些问题，我提出来后在群里交流下发现可以通过其他方式解决。

- 现在的想法是首先要搞懂生成快照的时机，当快照生成的时刻就是状态存储能够恢复的到的时刻，所以至少要保证这个时刻的状态能同步在磁盘上；而且还要注意HA情形下的快照生成和恢复时机，这个跟刚才同理。
- 再一点就是，我需要保证每次状态更新的时候带上版本号，或者更新版本信息。使得内存中获取状态时，能拿到最新状态；而恢复时则能找到某个时刻的状态版本。
- 还要注意，某些状态可能不会频繁更新，所以在恢复的时候可能要找到这个状态在某个时刻的版本号；或者要保证所有版本都同步在磁盘上，这个时候我就可以找到那些最接近恢复时刻的状态版本。

话说回来，我还想问问一般带有版本信息的存储引擎实现的方式是什么样的。是类似OLTP的MVCC版本链那套设计么？感觉无论如何肯定要存下一个版本号，类似把存储当作一个`map<Key, list<pair<Version, Value>>>`的结构。如何让设计简洁并且能提供上述保证就是下周的任务了。

慢慢的有自研的感觉了，类似于从某些已有经历中发现需要注意的问题，并从过去的设计中找到共同点，然后再按实际情况发挥这样子。这整个的过程又是一轮学习的过程。

## 毕业设计

能够跑起一个aarch64的CentOS了，似乎这周就干了这样一件事情。

刚刚跟队友交流了一下，正好在这里梳理一下下周的工作：后端API对接好前端、跑一次aarch64的任务、整理aarch64部署脚本、提供带performance基准的测试、拯救网络挂掉的服务器，并在服务器上部署一套测试环境。这估计至少得有3天的样子... 救命！

# 学习

## CMU15445 - Fall2022

> - B+Tree Insertions：https://www.youtube.com/watch?v=h6Mw7_S4ai0
> - B+Tree Deletions：https://www.youtube.com/watch?v=QrbaQDSuxIM

开始了B+Tree，写好了task1，考虑了task2增删的场景。考虑下周末给他写完，如果毕设顺利的话，感觉问题不大？

顺带一提，上面的两个视频链接我觉得是最能展示B+Tree算法的简单例子，之前写445作业的时候就参考的它。

# 生活

## 运动

这周没有跑步（不过有很大程度懒的因素），想测试下跑步对减重的速度有多大影响。周三还出去吃了趟自助餐，吃了大概两公斤，对结果可能有些影响。...不过问题不大！

上周减了1.8公斤，这周减了1.3公斤。如果忽略大餐的影响，看来跑步能多减一斤大概。当然大餐应该是忽略不了的，饮食是相当重要的一环，所以可能跑步能多减几两的样子。按照运动一万千卡减一公斤的说法，这周少运动了1600千卡左右，相当于少减0.16公斤。那看来这个计算公式有点保守，或者我有些运动没有计算在内。

## 板绘

很可惜，这周没有多少板绘诶。因为工作ddl和毕设把我整的有些焦虑，所以时间拿来放松了。不过我似乎还花了一些时间花了梅花。

![drawing_practice](/static/image/2023-02-19/drawing_practice.jpeg)

最近也试了试 ControlNet + Diffusion作图，简单画了个蘑菇的轮廓，就能补全出这样的效果。真的很不错诶，不像之前线稿填色，现在AICG能绘制出一些纹理和背景。

![scribble-diffusion-mushrooms](/static/image/2023-02-19/scribble-diffusion-mushrooms.png)