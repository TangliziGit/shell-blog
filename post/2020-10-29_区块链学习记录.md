# 区块链的一些概念

> 引用自<区块链实战: 从技术创新到商业模式>

因为区块链是一个从工程出发的新的技术, 一些概念尚未确定下来. 下面是本人根据书籍总结得来.



**区块链**

- 是一种无中心节点的分布式数据库, 各个全节点保存着完整的数据, 并且存储操作的效率很低且容量不应大.

- 主要特性包括: 分布式数据库, 共识算法, 点对点通信, 数据公开, 数字签名的自主账户, 智能合约.

- 通过共识算法提供节点间的一致性, 通过哈希算法和非对称加密算法保证数据的可验证能力.<br>这两个技术是难以篡改数据的基础.

  

**账本**

- 是交易数据组成的数据集合.



**共识机制**

- 是一类分布式一致性算法(注意FLP不可能结果和CAP理论), 但基于部分节点不是诚实的这个条件.
- 目的是维护各个节点的一致性.
- 效率必然低于集中式数据库, 高性能不是区块链中共识规则的根本目的.



**公链 / 私链 / 联盟链**

- 即所有人都可以参与的区块链 / 获得许可的用户参与的区块链(各种操作具有权限控制)
- 公链对共识机制要求很高, 需要可靠性杜绝恶意节点.<br>非公链对共识机制要求低, 结合其他权限规则等可以保证数据安全和一致性.



**点对点通信的发展**

- BitTorrent协议: 将文件分割成大小相等的区域, 并将每个块的索引和哈希值记录于种子文件. 下载者根据自己持有的块信息, 和对等方交换数据.
- Kademlia协议: 基于分布式哈希表. 根据节点的ID异或值划分自树构建路由表建立网络, 更加高效.
- 比特币协议: 基于P2P协议技术
- 以太坊: 基于Kademlia技术



**自主账户**

- 账户的创建是指生成一对公钥和私钥. <br>公钥用于证明自己是一个不同于其他账户的信息.<br>私钥用于证明数据是否真实.
- 公钥与现实中的人是无法对应的. 但是大数据技术和执法机构等, 可以根据使用公钥产生的交易特征来识别出现实中的人.
- (注意: 私钥专门用于解密向自己发来的消息. 如果用公钥解密向自己发来的消息, 那么中间人可随意查看.)



**区块链的分类**

- 专用区块链: 区块链, 数字货币和比特币应用三者结合. 如比特币和各种分叉币. 
- 可扩展区块链: 通过智能合约提供可编程和可扩展能力. 如以太坊, R3 Codra.
- 模块化区块链: 区块链被组件化, 可以被替代和启用. 如 Hyperledger Fabric



**区块链发展**

- 区块链1.0: 区块链网络, 单一协议和应用三者结合.
- 区块链2.0: 增加了可以运行智能合约的程序, 提供可编程和可扩展能力.
- 区块链3.0: 区块链作为基础设施, 支持各行各业.



# 区块链技术基础

> 引用自<区块链技术与应用>公开课 北京大学肖臻

> <https://blog.csdn.net/Mu_Xiaoye/article/details/104299664>



## 密码学原理



### 哈希算法性质

**Collision Resistance**

- 如果有Hash(x)!=Hash(y)，必然可以得到x!=y

- 或者说如果x=y, 则Hash(x) == Hash(y)

  

**Hiding**

- 能够由x推出H(x)， 但是难以从H(x) 推到 x。
- hiding成立的前提是输入的x空间，足够大，人们才无法使用暴力法来求解出x。



**Digital Commitment(数据保证)**

- 由collision resistance和hiding结合实现

- 某个人对某个股票进行涨停预测，我们如何保证能够知晓其预测是否准确？<br>当提前发布预测后，可能会由于预测者本身对股市实际结果造成影响。<br>所以，应该将提前将其写于纸上并密封，交给第三方机构保管，等到实际结果出现后开启密封与实际对比，而第三方机构需要能够使人信服.<br>在实际生活中，有很多场景并不存在一个这样的第三方机构，而区块链技术正为此提供了一个很好的解决方法。



**Puzzle Friendly**

- 该性质要求哈希值计算事先不可预测，仅仅根据输入很难预测出输出。
- 例如：我们需要一个哈希值，存在于某一个范围内，只能通过不停运算查找出来。该性质保证了工作量证明(POW)机制可以运行。



### 数字签名

- 公钥和私钥的应用保证了“签名”的应用。
- 当在比特币网络中进行转账时，通过“签名”可以明确是由哪个账户转出的，从而防止不良分子对其他账户比特币的盗取。
- 在发布交易时，通过自己私钥签名，其他人可以根据公钥进行验证，从而保证该交易由自己发起。<br>私钥在这里的作用是, 声明比特币是从自己转出的(只能用对应公钥成功验证)。<br>



## 区块链数据结构



### Hash Pointer

**哈希指针**

- 包括指向前一个区块的普通指针和数据哈希值的指针.
- 它保证了验证前一个数据真实性的能力.



**区块链数据结构**

- 由区块作为节点, 由哈希指针作为链接的链表.
- 区块头部包括: 版本号, 前一个区块的哈希指针, Ｍarkle树的根哈希指针, 挖矿难度target, 随机数nonce.<br>区块体包括: 交易列表<br>全节点保存整个区块的所有内容，而轻节点仅仅保存区块的块头信息
- 区块必须保证以下规则, 才能是一个有意义的区块:

  1. `Hash(Block Header) <= target`

  2. `target`是协议中有效的

  3. 在最长合法链上, 即不是一个分支


- 整个区块链保证了数据难以篡改的能力, 前依法而动全身.




### Ｍarkle Tree

**Markle Tree**

- 将二叉树的非叶节点替换为哈希指针, 叶节点替换为交易数据的树.
- 作用是提供Markle Proof, 即证明某个交易存在(可计算hash并能够索引到, 即Hash Pointer).<br>即根据其他节点提供的Markle Tree的路径节点和自己节点的根哈希指针计算和比较.
- 排序Markle Tree可以提供证明交易不存在的快速算法Ｏ(logn)<br>即对每个交易节点的hash进行排序, 二分查找该索引两边的节点, 再进行Markle Proof证明两个节点相邻. <br>(无中间交易即不存在目标交易)



## 共识协议

**比特币的核心问题**

- 谁来发行币? <br>仅由`coinbase`发行, (但可以作为奖励给创建区块的用户).
- 如何验证货币合法性? 即处理双花问题<br>